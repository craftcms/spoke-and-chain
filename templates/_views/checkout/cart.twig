{# Layout #}
{% extends '_layouts/site' %}

{# Variables #}
{% set checkoutPage = craft.entries({ section: 'checkout', type: 'checkout' }).one() %}

{# Blocks #}
{% block content %}
  <!-- Template: {{ _self }}.twig -->

  {# Heading #}
  <div class="container py-4 text-center">
    <h1>{{ entry.heading }}</h1>
    <h2>{{ entry.subheading }}</h2>
  </div>

  {# Cart #}
  <div class="container flex justify-center">
    <div class="border-t border-gray-300 w-full max-w-5xl">
      {% if not cart.lineItems|length %}
        {{ entry.body }}
      {% else %}
        <form method="post">
          {{ csrfInput() }}
          {{ hiddenInput('action', 'commerce/cart/update-cart') }}

          {% for lineItem in cart.lineItems %}
            <div class="flex flex-wrap border-b border-gray-300 py-8">
              {# Image #}
              <div class="w-full md:w-1/3 lg:w-1/5">
                <img class="w-full" src="https://source.unsplash.com/220x130/?bike" alt="">
              </div>

              <div class="flex flex-wrap md:w-2/3 lg:w-4/5">
                {# Product #}
                <div class="w-full lg:w-1/2">
                  <div>{{ lineItem.description }}</div>
                  <div>{{ lineItem.sku }}</div>
                </div>

                {# Quantity #}
                <div class="w-full md:w-1/2 lg:w-1/4">
                  <label for="qty">{{ 'Quantity'|t }}</label>
                  <input id="qty" name="lineItems[{{ lineItem.id }}][qty]" type="text" value="{{ lineItem.qty }}">
                </div>

                {# Price #}
                <div class="w-full md:w-1/2 lg:w-1/4">
                  {{ lineItem.subtotalAsCurrency }}
                </div>
              </div>
            </div>
          {% endfor %}

          <div class="flex justify-end">
            <div class="w-full xl:w-4/5">
              <div class="flex items-center w-full justify-between">
                <div>Shipping</div>
                <div class="text-right">{{ cart.totalShippingCostAsCurrency }}</div>
              </div>
              <div class="flex items-center w-full justify-between">
                <div>Tax</div>
                <div class="text-right">{{ cart.totalTaxAsCurrency }}</div>
              </div>
              <div class="flex items-center w-full justify-between">
                <div>Discount</div>
                <div class="text-right">{{ cart.totalDiscountAsCurrency }}</div>
              </div>
              <div class="flex items-center w-full justify-between py-4 border-t border-b border-gray-300">
                <div class="font-bold">Total</div>
                <div class="text-right">{{ cart.totalPriceAsCurrency }}</div>
              </div>

              <div class="pt-4">
                <input class="button" type="submit" name="submit" value="{{ 'Update cart'|t }}">
                {% if checkoutPage %}
                  <a class="button" href="{{ checkoutPage.url }}">{{ 'Checkout'|t }}</a>
                {% endif %}
              </div>
            </div>
          </div>
        </form>
      {% endif %}
    </div>
  </div>
{% endblock %}